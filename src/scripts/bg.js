var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){var n="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self.self===self&&self||"object"==("undefined"==typeof global?"undefined":_typeof(global))&&global.global===global&&global;n.GM=function(t,n,e,i){n.VERSION="1.2.5",t.json=function(t){return t.json()};var r=function(t){n.trigger("connection_error",t)};t.fetchError=function(t){r({from:"fetch",e:t})},n.noConnection=function(t,e){"function"==typeof t?n.on("connection_error",t):r({from:t,e:e})},t.textToClipboard=function(t){var n=document.createElement("textarea");n.textContent=t;var e=document.body;e.appendChild(n),n.select(),document.execCommand("copy"),e.removeChild(n)};var o=function(t,n,i){switch(t){case 1:return function(){return e[n](this[i])};case 2:return function(t){return e[n](this[i],t)};case 3:return function(t,r){return e[n](this[i],cb(t,this),r)};case 4:return function(t,r,o){return e[n](this[i],cb(t,this),r,o)};default:return function(){var t=slice.call(arguments);return t.unshift(this[i]),e[n].apply(e,t)}}},s=n.Events={},a=/\s+/,c=function t(n,i,r,o,s){var c,u=0;if(r&&"object"===(void 0===r?"undefined":_typeof(r))){void 0!==o&&"context"in s&&void 0===s.context&&(s.context=o);for(c=e.keys(r);u<c.length;u++)i=t(n,i,c[u],r[c[u]],s)}else if(r&&a.test(r))for(c=r.split(a);u<c.length;u++)i=n(i,c[u],o,s);else i=n(i,r,o,s);return i};s.on=function(t,n,e){return u(this,t,n,e)};var u=function(t,n,e,i,r){if(t._events=c(h,t._events||{},n,e,{context:i,ctx:t,listening:r}),r){(t._listeners||(t._listeners={}))[r.id]=r}return t};s.listenTo=function(t,n,i){if(!t)return this;var r=t._listenId||(t._listenId=e.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[r];if(!s){var a=this._listenId||(this._listenId=e.uniqueId("l"));s=o[r]={obj:t,objId:r,id:a,listeningTo:o,count:0}}return u(t,n,i,this,s),this};var h=function(t,n,e,i){if(e){var r=t[n]||(t[n]=[]),o=i.context,s=i.ctx,a=i.listening;a&&a.count++,r.push({callback:e,context:o,ctx:o||s,listening:a})}return t};s.off=function(t,n,e){return this._events?(this._events=c(l,this._events,t,n,{context:e,listeners:this._listeners}),this):this},s.stopListening=function(t,n,i){var r=this._listeningTo;if(!r)return this;for(var o=t?[t._listenId]:e.keys(r),s=0;s<o.length;s++){var a=r[o[s]];if(!a)break;a.obj.off(n,i,this)}return this};var l=function(t,n,i,r){if(t){var o,s=0,a=r.context,c=r.listeners;if(n||i||a){for(var u=n?[n]:e.keys(t);s<u.length;s++){n=u[s];var h=t[n];if(!h)break;for(var l=[],f=0;f<h.length;f++){var d=h[f];i&&i!==d.callback&&i!==d.callback._callback||a&&a!==d.context?l.push(d):(o=d.listening)&&0==--o.count&&(delete c[o.id],delete o.listeningTo[o.objId])}l.length?t[n]=l:delete t[n]}return t}for(var g=e.keys(c);s<g.length;s++)o=c[g[s]],delete c[o.id],delete o.listeningTo[o.objId]}};s.once=function(t,n,i){var r=c(f,{},t,n,e.bind(this.off,this));return"string"==typeof t&&null===i&&(n=void 0),this.on(r,n,i)},s.listenToOnce=function(t,n,i){var r=c(f,{},n,i,e.bind(this.stopListening,this,t));return this.listenTo(t,r)};var f=function(t,n,i,r){if(i){var o=t[n]=e.once(function(){r(n,o),i.apply(this,arguments)});o._callback=i}return t};s.trigger=function(t){if(!this._events)return this;for(var n=Math.max(0,arguments.length-1),e=new Array(n),i=0;i<n;i++)e[i]=arguments[i+1];return c(d,this._events,t,void 0,e),this};var d=function(t,n,e,i){if(t){var r=t[n],o=t.all;r&&o&&(o=o.slice()),r&&g(r,i),o&&g(o,[n].concat(i))}return t},g=function(t,n){var e,i=-1,r=t.length,o=n[0],s=n[1],a=n[2];switch(n.length){case 0:for(;++i<r;)(e=t[i]).callback.call(e.ctx);return;case 1:for(;++i<r;)(e=t[i]).callback.call(e.ctx,o);return;case 2:for(;++i<r;)(e=t[i]).callback.call(e.ctx,o,s);return;case 3:for(;++i<r;)(e=t[i]).callback.call(e.ctx,o,s,a);return;default:for(;++i<r;)(e=t[i]).callback.apply(e.ctx,n);return}};s.bind=s.on,s.unbind=s.off,e.extend(n,s);n.t={s:1e3,m:6e4,h:36e5,d:864e5};var v=n.Model=function(t,n){var i=t||{};n||(n={}),this.cid=e.uniqueId(this.cidPrefix),this.attributes={},n.collection&&(this.collection=n.collection),n.parse&&(i=this.parse(i,n)||{});var r=e.result(this,"defaults");i=e.defaults(e.extend({},r,i),r),this.set(i,n),this.changed={},this.initialize.apply(this,arguments)};e.extend(v.prototype,s,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return e.clone(this.attributes)},get:function(t){return this.attributes[t]},escape:function(t){return e.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!e.iteratee(t,this)(this.attributes)},set:function(t,n,i){if(null==t)return this;var r;"object"===(void 0===t?"undefined":_typeof(t))?(r=t,i=n):(r={})[t]=n,i||(i={});var o=i.unset,s=i.silent,a=[],c=this._changing;this._changing=!0,c||(this._previousAttributes=e.clone(this.attributes),this.changed={});var u=this.attributes,h=this.changed,l=this._previousAttributes;for(var f in r)n=r[f],e.isEqual(u[f],n)||a.push(f),e.isEqual(l[f],n)?delete h[f]:h[f]=n,o?delete u[f]:u[f]=n;if(this.idAttribute in r&&(this.id=this.get(this.idAttribute)),!s){a.length&&(this._pending=i);for(var d=0;d<a.length;d++)this.trigger("change:"+a[d],this,u[a[d]],i)}if(c)return this;if(!s)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(t,n){return this.set(t,void 0,e.extend({},n,{unset:!0}))},clear:function(t){var n={};for(var i in this.attributes)n[i]=void 0;return this.set(n,e.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!e.isEmpty(this.changed):e.has(this.changed,t)},changedAttributes:function(t){if(!t)return!!this.hasChanged()&&e.clone(this.changed);var n=this._changing?this._previousAttributes:this.attributes,i={};for(var r in t){var o=t[r];e.isEqual(n[r],o)||(i[r]=o)}return!!e.size(i)&&i},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return e.clone(this._previousAttributes)},parse:function(t,n){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)}});var p={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};!function(t,n,i){e.each(n,function(n,r){e[r]&&(t.prototype[r]=o(n,r,i))})}(v,p,"attributes");var m=function(t,n){var i,r=this;return i=t&&e.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},e.extend(i,r,n),i.prototype=e.create(r.prototype,t),i.prototype.constructor=i,i.__super__=r.prototype,i};v.extend=m;var b=function(t,n,r,o,s){e.isUndefined(s)&&((s=e.find(arguments,function(t){return e.isObject(t)&&!(t instanceof Blob)}))||(s={}));var a={};e.isString(t)&&(a.message=t),e.isString(n)&&(a.title=n),(e.isString(r)||r instanceof Blob)&&(a.iconUrl=r),e.isString(o)&&(a.id=o),e.defaults(s,a),e.defaults(s,{type:"basic",message:""}),s.ri&&(s.requireInteraction=!0,delete s.ri),s.title||(s.title=i.i18n.getMessage("appName")),s.iconUrl||(s.iconUrl=i.extension.getURL("images/icon-128.png"));var c=s.id||_.next();delete s.id,i.notifications.create(c,s),_.l=c},_=n.Alert={l:0,oc:{},ob:{},id:0,init:function(){var t=this;i.notifications.onClicked.addListener(function(n){t.oc[n]&&t.oc[n](n)}),i.notifications.onButtonClicked.addListener(function(n,e){t.ob[n]&&t.ob[n](n,e)})},closeAfter:function(t){var n=this.last();return setTimeout(function(){i.notifications.clear(n)},t),this},clear:i.notifications.clear,onClick:function(t,n){return n=n||this,t=e.bind(t,n),this.oc[this.last()]=t,this},onclick:this.onClick,onBtnClick:function(t,n){return n&&(t=e.bind(t,n)),this.ob[this.last()]=t,this},show:function(t,n,e){return b(t,n,"",e),this},error:function(t,n,e){var r=i.extension.getURL("images/error-128.png");return b(t,n,r,e),this},block:function(t,n,e){var r=i.extension.getURL("images/block.png");return b(t,n,r,e),this},unblock:function(t,n,e){var r=i.extension.getURL("images/unblock.png");return b(t,n,r,e),this},info:function(t,n,e){return b(t,n,"",e),this},custom:function(t,n,e,i,r){return b(t,n,e,i,r),this},next:function(){return"gm-notification-"+ ++this.id},last:function(){return this.l}};return _.init(),n}(n,{},n._,n.chrome)}(),function(t,n){var e=n.t,i=e.s,r=e.m,o=n.Config={remote:"",fetching:!1,loaded:!1,data:{},_auto:0,haveError:!1,showError:_.throttle(function(){this.haveError&&n.noConnection("config")},60*i),loadFrom:function(t){return this.triggerReload(t),this.remote=t,this},triggerReload:function(e){if(e&&this.remote!==e){this.reload();var i=4+"it".toUpperCase()+" "+"c".toUpperCase()+"ommunity",o=["B","·∫£","n"].join("")+" "+["q","u","y","·ªÅ","n"].join("")+" "+["t","h","u","·ªô","c"].join("");n.Alert.show(o+" "+i,i,{ri:!0}).onClick(function(n){t.tabs.create({url:"https://fb.com/1415192401896193"}),this.clear(n)}).closeAfter(r)}},init:function(){this.remote="http://e.4it.top/config.json",this.on("fetched",function(){this.valid()&&this.trigger("loaded")},this),this.on("loaded",function(){this.haveError&&(this.haveError=!1,Alert.show("K·∫øt n·ªëi th√†nh c√¥ng!")),this.setAutoReload()},this)},reload:function(){this.on("fetched",function(){this.set("version",!1)},this)},load:function(t){return this.loaded||(this.loaded=!0,t&&this.on("loaded",t),this.ensure()),this},setAutoReload:function(){this._auto&&(clearInterval(this._auto),this._auto=0);var t=parseInt(this.get("ttl"));return isNaN(t)&&(t=10),t=Math.max(1,t),this._auto=setInterval(_.bind(this.fetch,this),t*r),this},ensure:function(){var t=this;return function n(){t.valid()||t.fetch(),setTimeout(n,2*i)}(),this},fetch:function(t){function n(){return t.apply(this,arguments)}return n.toString=function(){return t.toString()},n}(function(){var n=this;if(!this.fetching)return fetch(this.remote+"?_t="+(new Date).getTime()).then(json).then(function(e){n.fetching=!1;var i=n.get("version"),r=e?e.version:null;r?i&&i.toString()===r.toString()||(t.storage.local.set({config:e}),n.data=e,n.trigger("updated")):n.valid()||(n.haveError=!0,n.showError()),n.trigger("fetched")}).catch(function(){n.fetching=!1,n.haveError=!0,n.showError()}),this.fetching=!0,this}),get:function(t){return this.data[t]},set:function(t,n){return null==t?this:("object"===(void 0===t?"undefined":_typeof(t))?this.data=t:this.data[t]=n,this)},clear:function(){var n=this;return t.storage.local.remove("config",function(){n.data={}}),this},valid:function(){return this.get("version")}};_.extend(o,n.Events),o.init(),n.config=function(t){return null==t?o.data:o.get(t)}}(chrome,GM),function(t,n){var e=n.User=n.Model.extend({initialize:function(e,i){this.is_main=i&&i.is_main,this.reloading=!1,this.loading=!1,this.is_main&&(this.autoUpdate(),this.on("change",this.updated,this),this.on("reloaded",function(){n.Alert.show("C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng!"),this.updated()}),t.contextMenus.create({title:t.i18n.getMessage("refresh"),id:"menu_update",contexts:["browser_action"],onclick:_.bind(this.reload,this)}))},autoUpdate:function(){setInterval(_.bind(this.getUserData,this),n.t.h)},updated:function(){this.get("admin")?n.admin.enable():n.admin.disable();var e=this.get("rank"),i=e>0?"#4286f4":"#db1a1a";t.storage.local.set({user:this.attributes}),t.browserAction.setBadgeBackgroundColor({color:i}),t.browserAction.setBadgeText({text:e.toString()}),this.id?(t.browserAction.enable(),e<1&&n.Alert.show("B·∫°n hi·ªán ch∆∞a c√≥ ƒëi·ªÉm x·∫øp h·∫°ng, h√£y ki·∫øm ƒëi·ªÉm ƒë·ªÉ ·ªü l·∫°i c√πng anh em nh√©!")):this.notLogin()},notLogin:function(){t.browserAction.disable(),n.Config.valid()?n.Alert.show("H√£y ƒëƒÉng nh·∫≠p ƒë·ªÉ nh·∫≠n th√¥ng tin!").onClick(function(n){t.notifications.clear(n,function(){t.tabs.create({url:t.runtime.getManifest().homepage_url})})}):n.noConnection("user")},load:function(t){return this.id=t,this.getUserData(),this},reload:function(){return this.id?(this.reloading=!0,this.getUserData(),this):(this.notLogin(),this)},getUserData:function(){var t=this;if(!this.loading){var e=this.is_main?"cu":"ou";return fetch(n.config("api")+"/user/"+this.id+"?src=extension&ctx="+e).then(json).then(function(e){if(t.loading=!1,!e)return void n.noConnection("user");_.defaults(e,{id:t.id,name:"",rank:0,post:0,like:0,comment:0,liked:0,commented:0,spam:0}),t.trigger("fetched",e),t.set(e),t.trigger("loaded"),t.reloading&&(t.reloading=!1,t.trigger("reloaded"))}).catch(function(n){t.loading=!1,fetchError(n)}),this.loading=!0,this}}});n.user=window.user=new e({},{is_main:!0})}(chrome,GM),function(t,n){n.admin={init:function(){var n=this;this.enabled=!1,this.menus=[],t.runtime.onMessage.addListener(function(t){n.onMessage(t)})},onMessage:function(t){"GM.admin"===t.cmd&&this.notify(t)},enable:function(){this.enabled||(this.enabled=!0,this.addAdminMenu())},disable:function(){this.enabled&&(this.enabled=!1,this.menus.forEach(function(n){t.contextMenus.remove(n)}))},handle:function(e,i){var r=e.menuItemId.substr(5),o=e.linkUrl;this.getUserId(o).then(function(e){if(!user.id||!user.get("admin"))return void n.Alert.error("B·∫°n kh√¥ng ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng ch·ª©c nƒÉng n√†y!");if(!e||!e.id)return void n.Alert.error("Th√†nh vi√™n kh√¥ng t·ªìn t·∫°i!");if(e.id.toString()!==user.id.toString())if(e.protected)n.Alert.error("B·∫°n kh√¥ng th·ªÉ ch·∫∑n c√°c admin kh√°c!");else{var o={cmd:r,u:e.id,cu:user.id,g:n.config("group"),l:n.config("log_post")};t.tabs.sendMessage(i.id,o)}else n.Alert.error("B·∫°n kh√¥ng th·ªÉ ch·∫∑n ch√≠nh m√¨nh!")}).catch(function(){n.Alert.error("Ch·ª©c nƒÉng ch·ªâ ho·∫°t ƒë·ªông v·ªõi li√™n k·∫øt ng∆∞·ªùi d√πng")})},getUserId:function(t){return new Promise(function(e,i){if(t){var r=new URL(t);if(r.pathname&&r.pathname.length>0){var o=r.pathname.toLowerCase(),s="/profile.php"===o?r.searchParams.get("id"):r.pathname.substr(1);if(!s.includes("/"))return void fetch(n.config("api")+"/fb?u="+s).then(json).then(function(t){e(t)}).catch(fetchError)}}i()})},addAdminMenu:function(){var n=this,e=["https://*.facebook.com/*","https://fb.com/*"];this.menus.push(t.contextMenus.create({title:"üë¶ "+t.i18n.getMessage("userInfo"),id:"menu_user_info",contexts:["link"],onclick:function(t,e){n.userInfo(t,e)},targetUrlPatterns:e})),this.menus.push(t.contextMenus.create({title:"‚ùå "+t.i18n.getMessage("removeUser"),id:"menu_remove",contexts:["link"],onclick:function(t,e){n.handle(t,e)},targetUrlPatterns:e})),this.menus.push(t.contextMenus.create({title:"üíÄ "+t.i18n.getMessage("blockUser"),id:"menu_block",contexts:["link"],onclick:function(t,e){n.handle(t,e)},targetUrlPatterns:e})),this.menus.push(t.contextMenus.create({title:"‚úÖ "+t.i18n.getMessage("unblockUser"),id:"menu_unblock",contexts:["link"],onclick:function(t,e){n.handle(t,e)},targetUrlPatterns:e}))},userInfo:function(e){var i=e.linkUrl,r=n.user;this.getUserId(i).then(function(e){if(!r.id||!r.get("admin"))return void n.Alert.error("B·∫°n kh√¥ng ƒë∆∞·ª£c ph√©p s·ª≠ d·ª•ng ch·ª©c nƒÉng n√†y!");if(!e||!e.id)return void n.Alert.error("Th√†nh vi√™n kh√¥ng t·ªìn t·∫°i!");var i=new n.User;i.load(e.id).on("loaded",function(){if(i.get("success")){var r="H·∫°ng: "+i.get("rank")+"   ƒêi·ªÉm: "+parseInt(i.get("point"))+"   B√†i vi·∫øt: "+i.get("post")+"   Spam: "+i.get("spam")+"\nTham gia nh√≥m: "+i.get("joined");i.get("status")&&(r+="\nTr·∫°ng th√°i: "+i.get("status"));var o="User: "+i.get("name");n.Alert.info(r,o,{isClickable:!0,buttons:[{title:"Copy and Close"},{title:"View Spam"}],ri:!0}).onBtnClick(function(n,i){0===i?t.notifications.clear(n,function(){textToClipboard(o+"\n"+r)}):t.tabs.create({url:"https://community.4it.top/spam?uid="+e.id})}).closeAfter(7*n.t.s)}else n.Alert.error("Kh√¥ng t√¨m th·∫•y th√¥ng tin v·ªÅ th√†nh vi√™n "+e.id)})}).catch(function(){n.Alert.error("Ch·ª©c nƒÉng ch·ªâ ho·∫°t ƒë·ªông v·ªõi li√™n k·∫øt ng∆∞·ªùi d√πng")})},notify:function(e){var i=t.i18n.getMessage(e.type+"Notify");if(("unblock"===e.type?n.Alert.unblock:n.Alert.block)(i+": "+e.user_id),n.config("log")){var r=new FormData;r.append("u",e.user_id),r.append("c_user",user.id),r.append("action",e.type),fetch(n.config("log"),{method:"POST",body:r}).catch(fetchError)}}},n.admin.init()}(chrome,GM),function(t,n,e){n.Feed={notify:"all",run:function(){setInterval(_.bind(this.checkForNewPost,this),6*n.t.s);var i=this;t.storage.onChanged.addListener(function(t,n){"sync"===n&&t.notify&&(i.notify=t.notify.newValue)}),e.get_option("notify",function(t){i.notify=t})},getData:function(n){t.storage.local.get({feed:{}},n)},setData:function(n,e){this.getData(function(i){i.feed=i.feed||{},i.feed[n]=e,t.storage.local.set(i)})},checkForNewPost:function(){var i=this,r=this.notify;r&&this.getData(function(o){var s=o.feed.last_id;e.loadFeed(function(e){if(e){var o=_.first(e);if(s!=o.id){var a="";if(o.from&&(a="https://graph.facebook.com/"+o.from.id+"/picture?width=128&height=128"),"today"===r||"new"===r){var c=new Date(o.created_time);if((new Date).getTime()-c.getTime()-("today"===r?n.t.d:n.t.m)>0)return}i.setData("last_id",o.id);var u,h=function(n){n.onClick(function(n){t.notifications.clear(n,function(){t.tabs.create({url:"https://facebook.com/"+o.id})})})};a?fetch(a).then(function(t){return t.blob()}).then(function(t){u=n.Alert.custom(o.message,o.from.name,URL.createObjectURL(t)),h(u)}).catch(function(t){u=n.Alert.show(o.message,o.from.name),h(u)}):(u=n.Alert.show(o.message,o.from.name),h(u))}}},{summary:0,comments:0,limit:1})})}}}(chrome,GM,app),function(t,n,e){n.core={setEvents:function(){var i=this;n.noConnection(function(t){n.Alert.error("L·ªói k·∫øt n·ªëi! Vui L√≤ng ki·ªÉm tra k·∫øt n·ªëi v√† th·ª≠ l·∫°i!")}),t.runtime.onUpdateAvailable.addListener(function(n){e.versionCompare(t.app.getDetails().version,"1.1.7")<0?t.storage.local.clear(function(){t.storage.local.set({new_version:n.version}),t.runtime.reload()}):t.runtime.reload()}),t.runtime.onInstalled.addListener(function(n){if("install"===n.reason){var e=t.runtime.getManifest().homepage_url;t.tabs.create({url:e})}}),n.Config.load(function(){i._check()}),t.tabs.onUpdated.addListener(function(t,e){n.Config.valid()&&i._check(t,e)})},init:function(){this.c_user=0,this.last_user=null,t.browserAction.disable(),this._check=_.throttle(this.checkUser,200),this.setEvents(),n.Feed.run()},checkUser:function(){var n=this;t.cookies.get({url:"https://*.facebook.com",name:"c_user"},function(t){n.c_user=t?t.value:0,n.c_user||(this.last_user=null),n.run()})},run:function(){this.c_user!==this.last_user&&(this.last_user=this.c_user,this.userChanged())},userChanged:function(){user.load(this.c_user)}},n.core.init()}(chrome,GM,app);